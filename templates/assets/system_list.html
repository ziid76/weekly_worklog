{% extends 'base.html' %}

{% block page_name %}시스템 관리{% endblock %}

{% block content %}
<div class="border bg-white p-3">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <form method="get" class="d-flex gap-2 align-items-center">
            <input type="text" name="q" class="form-control form-control-sm" placeholder="시스템명, 코드, 설명 검색"
                value="{{ request.GET.q }}" style="width: 300px; height: 31px; border-width: 1px;">
            <button type="submit" class="scl-btn scl-btn-sm rounded-pill" style="min-width: 60px;">검색</button>
        </form>
        <a href="{% url 'assets:system_create' %}" class="scl-btn scl-btn-primary scl-btn-sm">
            <i class="fas fa-plus"></i> 시스템 등록
        </a>
    </div>

    <div class="border bg-white p-3 table-responsive">
        <table class="display nowrap text-center" style="width:100%" id="list_table">
            <thead>
                <tr class="text-center">
                    <th>시스템명</th>
                    <th>코드</th>
                    <th>담당자</th>
                    <th>상태</th>
                    <th>오픈일</th>
                    <th>관리</th>
                </tr>
            </thead>
            <tbody>
                {% for system in systems %}
                <tr>
                    <td>
                        <a href="{% url 'assets:system_detail' system.pk %}" class="text-decoration-none">
                            {{ system.name }}
                        </a>
                    </td>
                    <td class="text-center">{{ system.code }}</td>
                    <td class="text-center">{{ system.manager.profile.display_name|default:system.manager.username }}
                    </td>
                    <td class="text-center">
                        <span
                            class="badge bg-{% if system.status == 'OPER' %}success{% elif system.status == 'DEV' %}warning{% elif system.status == 'SUSP' %}secondary{% else %}danger{% endif %}">
                            {{ system.get_status_display }}
                        </span>
                    </td>
                    <td class="text-center">{{ system.launch_date|default:"-" }}</td>
                    <td class="text-center">
                        <a href="{% url 'assets:system_edit' system.pk %}" class="btn btn-sm btn-outline-secondary">
                            <i class="fas fa-edit"></i>
                        </a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="text-center py-3">등록된 시스템이 없습니다.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

{% block extra_js%}

<script>
    $(document).ready(function () {
        $('#list_table').DataTable({
            "searching": false,
            "paging": false,
            "info": false,
            "ordering": false,
            "language": {
                "url": "https://cdn.datatables.net/plug-ins/1.11.3/i18n/ko.json"
            }
        });
    });
</script>

{% endblock %}